import { MongooseDataAccess } from '../database/mongoose/mongoose-data-access';
import { SequelizeDataAccess } from '../database/sequelize/sequelize-data-access';
import env from '../globals';

export function getDatabaseAccess() {
	// Vous pouvez baser votre choix sur une variable d'environnement
	// ou d'autres critères de configuration.
	const useMongoose = env.database.connectionString!.includes('mongodb') ? true : false;

	if (useMongoose) {
		return new MongooseDataAccess();
	} else {
		if (env.database.dialect === 'sqlite' && !env.database.storage) {
			throw Error('SQLite en mode mémoire nécessite un chemin de stockage');
		}

		return new SequelizeDataAccess();
	}
}
